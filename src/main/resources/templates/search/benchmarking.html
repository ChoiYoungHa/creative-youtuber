<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Creative Youtuber</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <div th:replace="~{include/css :: css-merge}"></div>
</head>
<body>
<div th:replace="~{include/preloader :: preloader}"></div>
<div th:replace="~{include/navbar :: header}"></div>

<main>
    <div id='loading_layer'
         style='position: fixed;z-index: 3000;top: 0;left: 0;width: 100%;height: 100%;display: none;justify-content: center;align-items: center;background-color: rgba(123, 123, 123, 0.4);writing-mode: vertical-lr;'>
        <img style='width:30%' src='/resource/boots/hosting_tp/assets/img/logo/creative_youtuber.png'/></div>
    <!-- Slider Area Start-->
    <div class="slider-area slider-bg ">
        <!-- Single Slider -->
        <div class="single-slider d-flex align-items-center slider-height3" style="height: 300px">
            <div class="container">
                <div class="row align-items-center justify-content-center">
                    <div class="col-xl-5 col-lg-9 col-md-8 " style="margin-top: 130px">
                        <div class="hero__caption hero__caption3 text-center">
                            <h1 data-animation="fadeInLeft" data-delay=".6s " style="font-family: 'GmarketSansMedium', sans-serif;">êµ¬ë…ì ëŒ€ë¹„ ì¡°íšŒìˆ˜ ë†’ì€ ì˜ìƒì°¾ê¸°</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Slider Area End -->
    <!--?  Form Area start  -->
    <section class="contact-section">
        <div class="container">
            <div class="d-none d-sm-block mb-5 pb-4">
                <div class="col-lg-8" style="margin-left: 20rem">

                        <div class="row">
                            <div class="col-8">
                                <div>
                                    <!--Hero form -->
                                    <form class="search-box ml-10" style="width: 800px" onsubmit="return false">
                                        <div class="input-form">
                                            <input type="text" placeholder="í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”" id="bench_keyword">
                                            <!-- icon search -->
                                            <div class="search-form">
                                                <button type="button" onclick="requestBenchData()" value="ê²€ìƒ‰"><i class="ti-search"></i></button>
                                            </div>
                                            <!-- icon search -->
                                            <div class="world-form">
                                                <i class="fa-solid fa-video"></i>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                </div>

            </div>
        </div>
        <div class="section-top-border">
            <h1 class="mb-20 gj-text-align-center">Benchmarking Videos</h1>
            <div class="progress-table-wrap">
                <div class="progress-table">
                    <div class="table-head">
                        <div class="serial">ì¡°íšŒìˆ˜</div>
                        <div class="country">ì¸ë„¤ì¼</div>
                        <div class="visit">ì±„ë„ëª…</div>
                        <div class="percentage">ì„¤ëª…</div>
                    </div>
                    <div class="table-row">
                        <div class="serial">3055462</div>
                        <div class="country"><a href="https://www.youtube.com/watch?v=6H5KKqV8BA4" target="_blank" style="display: contents"><div style="display: inline-block"><img src="https://i.ytimg.com/vi/6H5KKqV8BA4/default.jpg" alt="thumbnails" style="width:120px; height:68px; border-radius: .25rem;"></div><span style="color: black; padding-right: 10px">[ì›ƒê¸´ë™ë¬¼ì˜ìƒ] ì‹œë¹„ ê±°ëŠ” ìº¥ê±°ë£¨ ğŸ¦˜ ë‚´ í‚¥ì— ë§ì•„ë³¼ë˜? ã…‹ã…‹ ğŸ˜˜</span></a></div>
                        <div class="visit">ë‹ˆê¼¬ë¼ì§€TV</div>
                        <div class="percentage">ìº¥ê±°ë£¨ #ë™ë¬¼ì‹¸ì›€ #í˜¸ì£¼ë™ë¬¼ì˜ìƒ #í˜¸ì£¼ì—¬í–‰ #ì•¼ìƒë™ë¬¼ #ë™ë¬¼ì˜ì„¸ê³„ #ë™ë¬¼ë¹„ë””ì˜¤ #funnyanimal #kangaroo #wallaby.</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Area End -->
</main>



<div th:replace="~{include/footer :: footer}"></div>
<div th:replace="~{include/js :: js-merge}"></div>
<script>

    async function requestBenchData() {
        const bench_keyword = document.getElementById('bench_keyword').value.trim();
        if (!bench_keyword) {
            alert("í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        reloading_st();

        const formData = new FormData();
        formData.append('keyword', bench_keyword);

        try {
            const response = await fetch('/core/youtubeBenchmarking', {
                method: 'POST',
                body: formData
            });
            const data = await response.json();
            if (data.length === 0) {
                alert("ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
                loading_ed();
                return;
            }
            updateTable(data);
        } catch (error) {
            console.error('Error:', error);
            alert("ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            loading_ed();
        }
    }

    function updateTable(data) {
        const table = document.querySelector('.progress-table');
        const rowTemplate = document.querySelector('.table-row').cloneNode(true);  // í–‰ í…œí”Œë¦¿ ë³µì‚¬

        // í…Œì´ë¸” ì´ˆê¸°í™”
        while (table.children.length > 1) {
            table.removeChild(table.lastChild);
        }

        // ë°ì´í„°ë¡œ í…Œì´ë¸” ì±„ìš°ê¸°
        data.forEach((item, index) => {
            const row = rowTemplate.cloneNode(true);

            row.querySelector('.serial').textContent = item.viewCount;
            let thumbnailCell = row.querySelector('.country');
            thumbnailCell.innerHTML = `<a href="${item.url}" target="_blank" style="display: contents;"><div style="display: inline-block"><img src="${item.thumbnailUrl}" alt="thumbnails" style="width:120px; height:68px; border-radius: .25rem;"></div><span style="color: black;">${item.title}</span></a>`;  // ì¸ë„¤ì¼ ì´ë¯¸ì§€ì— ìŠ¤íƒ€ì¼ ì¶”ê°€
            row.querySelector('.visit').textContent = item.channelTitle;
            row.querySelector('.percentage').textContent = item.description;

            table.appendChild(row);  // í…Œì´ë¸”ì— í–‰ ì¶”ê°€
        });
        loading_ed();
    }


    function loading_st() {
        let layer_str = "<div id='loading_layer' style='position: fixed;z-index: 3000;top: 0;left: 0;width: 100%;height: 100%;display: flex;justify-content: center;align-items: center;background-color: rgba(123 ,123 ,123 , 0.4);writing-mode: vertical-lr;'><img style='width:30%' src='/resource/boots/hosting_tp/assets/img/logo/creative_youtuber.png'></div>"
        document.write(layer_str);
    }

    function loading_ed() {
        let ta = document.getElementById('loading_layer');
        ta.style.display = 'none';
    }

    function reloading_st() {
        let re = document.getElementById('loading_layer');
        re.style.display = 'flex';
    }
</script>
</body>
</html>